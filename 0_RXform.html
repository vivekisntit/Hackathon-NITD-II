<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mess Feedback Form</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0; padding: 0;
      background: #f4f4f9;
    }
    section { display: none; padding: 20px; }
    section.active { display: block; }

    .form-container {
      max-width: 500px;
      margin: auto;
      background: #fff;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    .form-group { margin-bottom: 15px; }
    label { display: block; margin-bottom: 5px; font-weight: bold; }
    input, select {
      width: 100%; padding: 8px;
      border: 1px solid #ccc; border-radius: 6px;
    }
    button {
      padding: 10px 20px;
      border: none; border-radius: 6px;
      background: #4CAF50; color: white;
      font-size: 16px; cursor: pointer;
    }
    button:disabled { background: #ccc; cursor: not-allowed; }

    table { width: 100%; border-collapse: collapse; background: #fff; margin-top: 20px; }
    th, td {
      border: 1px solid #ccc; padding: 10px; text-align: center; position: relative;
    }
    th { background: #eee; }

    .rating-box {
      display: none; position: absolute;
      background: white; border: 1px solid #ccc;
      padding: 5px; border-radius: 6px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
      top: 100%; left: 50%; transform: translateX(-50%);
      z-index: 10;
    }
    .star { font-size: 20px; cursor: pointer; color: #ccc; }
    .star.selected, .star:hover { color: gold; }

    .meal-block {
      margin-bottom: 20px;
    }
    select[multiple] {
      width: 100%;
      height: 150px;
      padding: 8px;
      border-radius: 6px;
      border: 1px solid #ccc;
    }
  </style>
</head>
<body>

<section id="page1" class="active">
  <div class="form-container">
    <h2>Student Details</h2>
    <div class="form-group">
      <label>Name</label>
      <input type="text" id="name" required>
    </div>
    <div class="form-group">
      <label>Roll No</label>
      <input type="text" id="roll" required>
    </div>
    <div class="form-group">
      <label>Semester</label>
      <input type="text" id="sem" required>
    </div>
    <div class="form-group">
      <label>Department</label>
      <input type="text" id="dept" required>
    </div>
    <div class="form-group">
      <label>Hostel Name</label>
      <input type="text" id="hostel" required>
    </div>
    <div class="form-group">
      <label>Food Preference</label>
      <select id="pref" required>
        <option value="">Select</option>
        <option value="veg">Vegetarian</option>
        <option value="non-veg">Non-Vegetarian</option>
      </select>
    </div>
    <button onclick="goToPage(2)">Next</button>
  </div>
</section>

<section id="page2">
  <h2>Current Menu Rating</h2>
  <div class="whole_table">
    <table>
      <thead>
        <tr>
          <th>Meal</th>
          <th>Monday</th>
          <th>Tuesday</th>
          <th>Wednesday</th>
          <th>Thursday</th>
          <th>Friday</th>
          <th>Saturday</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>Breakfast</th>
          <td>a<br>b<br>c<br>d<br>e<br>f<br>g</td>
          <td>a<br>b<br>c<br>d<br>e<br>f<br>g</td>
          <td>a<br>b<br>c<br>d<br>e<br>f<br>g</td>
          <td>a<br>b<br>c<br>d<br>e<br>f<br>g</td>
          <td>a<br>b<br>c<br>d<br>e<br>f<br>g</td>
          <td>a<br>b<br>c<br>d<br>e<br>f<br>g</td>
        </tr>
        <tr>
          <th>Lunch</th>
          <td>a<br>b<br>c<br>d<br>e<br>f<br>g</td>
          <td>a<br>b<br>c<br>d<br>e<br>f<br>g</td>
          <td>a<br>b<br>c<br>d<br>e<br>f<br>g</td>
          <td>a<br>b<br>c<br>d<br>e<br>f<br>g</td>
          <td>a<br>b<br>c<br>d<br>e<br>f<br>g</td>
          <td>a<br>b<br>c<br>d<br>e<br>f<br>g</td>
        </tr>
        <tr>
          <th>Snacks</th>
          <td>a<br>b<br>c<br>d</td>
          <td>a<br>b<br>c<br>d</td>
          <td>a<br>b<br>c<br>d</td>
          <td>a<br>b<br>c<br>d</td>
          <td>a<br>b<br>c<br>d</td>
          <td>a<br>b<br>c<br>d</td>
        </tr>
        <tr>
          <th>Dinner</th>
          <td>a<br>b<br>c<br>d<br>e<br>f<br>g</td>
          <td>a<br>b<br>c<br>d<br>e<br>f<br>g</td>
          <td>a<br>b<br>c<br>d<br>e<br>f<br>g</td>
          <td>a<br>b<br>c<br>d<br>e<br>f<br>g</td>
          <td>a<br>b<br>c<br>d<br>e<br>f<br>g</td>
          <td>a<br>b<br>c<br>d<br>e<br>f<br>g</td>
        </tr>
      </tbody>
    </table>
  </div>
  <button onclick="validateRatings()">Next</button>
</section>

<section id="page3">
  <h2>Select Your Menu (Pick at least 7 per meal)</h2>
  <div class="meal-block">
    <label>Breakfast</label>
    <select multiple id="breakfast"></select>
  </div>
  <div class="meal-block">
    <label>Lunch</label>
    <select multiple id="lunch"></select>
  </div>
  <div class="meal-block">
    <label>Snacks</label>
    <select multiple id="snacks"></select>
  </div>
  <div class="meal-block">
    <label>Dinner</label>
    <select multiple id="dinner"></select>
  </div>
  <button onclick="submitChoices()">Submit</button>
</section>

<script>
  let currentPage = 1;
  let ratings = {};

  function goToPage(n) {
    if (n === 2) {
      const fields = ["name","roll","sem","dept","hostel","pref"];
      for (let id of fields) {
        if (!document.getElementById(id).value.trim()) {
          alert("Please fill all details");
          return;
        }
      }
    }
    document.getElementById(`page${currentPage}`).classList.remove("active");
    document.getElementById(`page${n}`).classList.add("active");
    currentPage = n;

    if (n === 3) populateOptions();
  }

  document.querySelectorAll("td").forEach(cell => {
    const ratingBox = document.createElement("div");
    ratingBox.classList.add("rating-box");
    for (let i=1;i<=5;i++) {
      const star = document.createElement("span");
      star.classList.add("star");
      star.innerHTML = "â˜…";
      star.addEventListener("click", () => {
        ratings[cell.cellIndex + "-" + cell.parentNode.rowIndex] = i;
        [...ratingBox.children].forEach((s,j) => {
          s.classList.toggle("selected", j < i);
        });
      });
      ratingBox.appendChild(star);
    }
    cell.appendChild(ratingBox);
    cell.addEventListener("mouseenter", () => ratingBox.style.display = "block");
    cell.addEventListener("mouseleave", () => ratingBox.style.display = "none");
  });

  function validateRatings() {
    const totalCells = document.querySelectorAll("tbody td").length;
    if (Object.keys(ratings).length < totalCells) {
      alert("Please rate all cells before proceeding!");
    } else {
      goToPage(3);
    }
  }

  function populateOptions() {
    const meals = ["breakfast","lunch","snacks","dinner"];
    meals.forEach(m => {
      const select = document.getElementById(m);
      select.innerHTML = "";
      for (let i=1; i<=14; i++) {
        const opt = document.createElement("option");
        opt.value = m[0] + i;
        opt.textContent = m[0] + i;
        select.appendChild(opt);
      }
    });
  }

  function submitChoices() {
    const meals = ["breakfast","lunch","snacks","dinner"];
    for (let m of meals) {
      const chosen = Array.from(document.getElementById(m).selectedOptions);
      if (chosen.length < 7) {
        alert(`Please select at least 7 items for ${m}`);
        return;
      }
    }
    alert("Choices submitted successfully!");
  }
</script>
</body>
</html>
